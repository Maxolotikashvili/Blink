<div class="text-area-component-wrapper">
    <div class="messages-wrapper" #messagesWrapper> 
        <div class="message" [ngClass]="{'friend-message': message.sender !== 'user'}" *ngFor="let message of chatList; let i = index">
         
            <div class="date-separator" *ngIf="shouldShowDateSeparator(i)">
                <div class="line"></div>
                <span class="date bk-info-secondary">{{ getDateSeparator(message.timeStamp) }}</span>
                <div class="line"></div>
            </div>

            <div class="text-wrapper">
                <div class="groupchat-message-sender-wrapper" *ngIf="groupChat && message.sender !== 'user' && chatList[i]?.sender !== chatList[i-1]?.sender">
                    <span class="bk-info-secondary">{{message.sender}}</span>
                    <img class="avatar-img-small" src="maxo-lotikashvili.jpeg" alt="avatar">
                </div>

                <div class="timestamp-text-wrapper">
                    <span class="bk-info-secondary date" [ngClass]="{'date-active': clickedTextIndex === i + 1}"> {{message.timeStamp | date: 'hh:mm'}} </span>
                    
                    <button class="text" [ngClass]="{'text-active': clickedTextIndex === i + 1}" (click)="showTextDeliveryTime(i)">{{message.text}}</button>  
                </div>

                <div class="bk-info-secondary seen" *ngIf="message.lastSeen">seen</div>

                <div class="is-seen-by-wrapper" *ngIf="message.isSeenBy && message.isSeenBy.length > 0">
                    <span class="bk-info-secondary">seen by:</span>
                    <div class="bk-info-secondary seen" *ngFor="let seenBy of message.isSeenBy; let last = last">
                        <span>{{seenBy.username}}<span *ngIf="message.isSeenBy.length > 1 && !last">,</span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="!friend && !groupChat" class="bk-heading-h4 no-selected-friend-text">Select a chat to start messaging</div>
    
    <div class="input-area-wrapper" *ngIf="friend || groupChat">
        <img class="emoji" src="emoji.png" alt="">
        <div class="divider"></div>
        <textarea name="textarea" [(ngModel)]="textareaValue" cdkTextareaAutosize="true" rows="1" placeholder="Type here" (keypress)="handleTextSend($event)" #textArea></textarea>

        <button mat-flat-button class="square-button-small" type="button" (click)="handleTextSend($event)">
            <span class="send-text">Send</span>
            <img class="icon" src="send.png" alt="send">
        </button>
    </div>
</div>